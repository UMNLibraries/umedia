require 'test_helper'

  class SearchWithChilrenTest < ActiveSupport::TestCase
    it 'runs a search and returns child page data included in search results' do
      results = SearchWithChildren.new(param_string: 'q=libraries', rows: 2)
      results.docs.must_equal [{"id"=>"p16022coll208:6330", "object"=>"https://cdm16022.contentdm.oclc.org/utils/getthumbnail/collection/p16022coll208/id/6330", "set_spec"=>"p16022coll208", "collection_name"=>"World War Poster Collection", "collection_name_s"=>"World War Poster Collection", "collection_description"=>"Posters are from World Wars I and II and the German election of 1932. War posters are from U.S., Britain, Canada, France, Germany, Italy, Latin America, and Scandinavia. Subjects include recruiting, war bond sales, food conservation, civil defense and many other topics. Includes war posters from the collections of the Hennepin County Library. [Finding Aid available at: http://archives.lib.umn.edu/repositories/16/resources/2506]", "title"=>"517. Amiens. -- la bibliotheque. --", "title_s"=>"517. Amiens. -- la bibliotheque. --", "title_t"=>"517. Amiens. -- la bibliotheque. --", "title_sort"=>"517amienslabibliotheque", "description"=>"Photo of library ruins", "date_created"=>["1914 - 1918"], "date_created_ss"=>["1914 - 1918"], "date_created_sort"=>"1914 ", "historical_era"=>["World War, 1914-1918"], "caption"=>"Vise Paris no 517", "notes"=>"Text also in English", "types"=>["Still Image"], "format"=>["Postcards | http://vocab.getty.edu/aat/300026816"], "format_name"=>["Postcards"], "dimensions"=>"Approximately 14 centimeters", "subject"=>["World War, 1914 1918. France. Postcards", "libraries", "bombardment", "amiens (France)", "bombardment"], "subject_ss"=>["World War, 1914 1918. France. Postcards", "libraries", "bombardment", "amiens (France)", "bombardment"], "language"=>["French"], "country"=>["France"], "continent"=>["Europe"], "parent_collection"=>"World War Poster collection (Mss036); http://archives.lib.umn.edu/repositories/16/resources/2506", "parent_collection_name"=>"World War Poster collection (Mss036)", "contributing_organization"=>"University of Minnesota Libraries, Upper Midwest Literary Archives.", "contributing_organization_name"=>"University of Minnesota Libraries, Upper Midwest Literary Archives.", "contributing_organization_name_s"=>"University of Minnesota Libraries, Upper Midwest Literary Archives.", "contact_information"=>"University of Minnesota Libraries, Upper Midwest Literary Archives. 213 Elmer L. Andersen Library, 222 - 21st Avenue South, Minneapolis, MN 55455; https://www.lib.umn.edu/mss", "fiscal_sponsor"=>"This resource was created with support from the Institute of Museum and Library Services.", "local_identifier"=>["scp00367; scp00367b"], "dls_identifier"=>["scp00367; scp00367b"], "persistent_url"=>"http://purl.umn.edu/78786", "local_rights"=>"Use of this item may be governed by US and international copyright laws. You may be able to use this item, but copyright and other considerations may apply. For possible additional information or guidance on your use, please contact the contributing organization.", "page_count"=>2, "record_type"=>"primary", "first_viewer_type"=>"image", "viewer_type"=>"COMPOUND_PARENT_NO_VIEWER", "attachment"=>"7516.cpd", "document_type"=>"item", "featured_collection_order"=>999, "_version_"=>1628520507931361282, "type"=>"Still Image", "collection"=>"p16022coll208", "is_compound"=>true, "parent_id"=>"6330", "thumb_url"=>"https://cdm16022.contentdm.oclc.org/utils/getthumbnail/collection/p16022coll208/id/6330", "thumb_cdn_url"=>"https://d2y23onbq5rnfc.cloudfront.net/4a4ea35fb45bd9c5aad87aa8bd62830b5d456107.png", "children"=>[{"id"=>"p16022coll208:6328", "object"=>"https://cdm16022.contentdm.oclc.org/utils/getthumbnail/collection/p16022coll208/id/6328", "set_spec"=>"p16022coll208", "collection_name"=>"World War Poster Collection", "collection_name_s"=>"World War Poster Collection", "collection_description"=>"Posters are from World Wars I and II and the German election of 1932. War posters are from U.S., Britain, Canada, France, Germany, Italy, Latin America, and Scandinavia. Subjects include recruiting, war bond sales, food conservation, civil defense and many other topics. Includes war posters from the collections of the Hennepin County Library. [Finding Aid available at: http://archives.lib.umn.edu/repositories/16/resources/2506]", "title"=>"Front", "title_s"=>"Front", "title_t"=>"Front", "title_sort"=>"front", "dls_identifier"=>["scp00367"], "page_count"=>0, "record_type"=>"secondary", "parent_id"=>"6330", "first_viewer_type"=>"image", "viewer_type"=>"image", "child_index"=>0, "attachment"=>"7514.jp2", "document_type"=>"item", "featured_collection_order"=>999, "_version_"=>1628520587247747080, "type"=>nil, "collection"=>"p16022coll208", "is_compound"=>false, "thumb_url"=>"https://cdm16022.contentdm.oclc.org/utils/getthumbnail/collection/p16022coll208/id/6328", "thumb_cdn_url"=>"https://d2y23onbq5rnfc.cloudfront.net/d6aea1db32937e5891d1e6bbcd7bf58434aa22d0.png"}, {"id"=>"p16022coll208:6329", "object"=>"https://cdm16022.contentdm.oclc.org/utils/getthumbnail/collection/p16022coll208/id/6329", "set_spec"=>"p16022coll208", "collection_name"=>"World War Poster Collection", "collection_name_s"=>"World War Poster Collection", "collection_description"=>"Posters are from World Wars I and II and the German election of 1932. War posters are from U.S., Britain, Canada, France, Germany, Italy, Latin America, and Scandinavia. Subjects include recruiting, war bond sales, food conservation, civil defense and many other topics. Includes war posters from the collections of the Hennepin County Library. [Finding Aid available at: http://archives.lib.umn.edu/repositories/16/resources/2506]", "title"=>"Back", "title_s"=>"Back", "title_t"=>"Back", "title_sort"=>"back", "dls_identifier"=>["scp00367b"], "page_count"=>0, "record_type"=>"secondary", "parent_id"=>"6330", "first_viewer_type"=>"image", "viewer_type"=>"image", "child_index"=>1, "attachment"=>"7515.jp2", "document_type"=>"item", "featured_collection_order"=>999, "_version_"=>1628520587247747081, "type"=>nil, "collection"=>"p16022coll208", "is_compound"=>false, "thumb_url"=>"https://cdm16022.contentdm.oclc.org/utils/getthumbnail/collection/p16022coll208/id/6329", "thumb_cdn_url"=>"https://d2y23onbq5rnfc.cloudfront.net/c7ea96600880bd3df903b552ca1bd1a2b087702e.png"}]}, {"id"=>"p16022coll110:30", "object"=>"https://cdm16022.contentdm.oclc.org/utils/getthumbnail/collection/p16022coll110/id/30", "set_spec"=>"p16022coll110", "collection_name"=>"William Channing Whitney Collection", "collection_name_s"=>"William Channing Whitney Collection", "collection_description"=>"The collection contains renderings and elevations for many houses executed in watercolor and pen and ink, including the residences of Thomas Irvine, Rufus Rand, E.J. Phelps, W.H. Dunwoody and C.C. Bovey. There are also renderings for the Minneapolis Club (1892) and the Minnesota Building at the Chicago World's Fair (1893), plus 11 photographs, mainly taken from contemporary architectural publications, depicting Whitney's designs for the Dunwoody and Smith residences, the Minneapolis Club and the Minnesota Building. The collection also includes sets of original plans for the W.H. Lee residence (1913) and H.H. Leavitt residence (1905), as well as bluelines of the plans for the George B. Lane residence (1907), all located in Minneapolis. In addition to the plans and renderings, the collection contains photo albums of Whitney-designed buildings. [Finding Aid available at: http://archives.lib.umn.edu/repositories/8/resources/2249]", "title"=>"Stanley Library", "title_s"=>"Stanley Library", "title_t"=>"Stanley Library", "title_sort"=>"stanleylibrary", "creator"=>["Whitney, William Channing, 1851-1945"], "creator_ss"=>["Whitney, William Channing, 1851-1945"], "creator_sort"=>"whitneywilliamchanning18511945", "types"=>["Still Image"], "format"=>["Renderings (drawings) | http://vocab.getty.edu/aat/300034727"], "format_name"=>["Renderings (drawings)"], "dimensions"=>"10 x 16-1/2 inches", "country"=>["United States"], "continent"=>["North America"], "parent_collection"=>"William Channing Whitney Collection (N13); http://purl.umn.edu/39376", "parent_collection_name"=>"William Channing Whitney Collection (N13)", "contributing_organization"=>"University of Minnesota Libraries, Northwest Architectural Archives.", "contributing_organization_name"=>"University of Minnesota Libraries, Northwest Architectural Archives.", "contributing_organization_name_s"=>"University of Minnesota Libraries, Northwest Architectural Archives.", "contact_information"=>"University of Minnesota Libraries, Northwest Architectural Archives. 213 Elmer L. Andersen Library, 222 - 21st Avenue South, Minneapolis, MN 55455; https://www.lib.umn.edu/naa", "local_identifier"=>["OS Box 02; n13-Rendering 31"], "dls_identifier"=>["mss09804"], "persistent_url"=>"http://purl.umn.edu/127614", "local_rights"=>"Use of this item may be governed by US and international copyright laws. You may be able to use this item, but copyright and other considerations may apply. For possible additional information or guidance on your use, please contact the contributing organization.", "page_count"=>0, "record_type"=>"primary", "first_viewer_type"=>"image", "viewer_type"=>"image", "attachment"=>"31.jp2", "document_type"=>"item", "featured_collection_order"=>999, "_version_"=>1628471933495410688, "type"=>"Still Image", "collection"=>"p16022coll110", "is_compound"=>false, "parent_id"=>"30", "thumb_url"=>"https://cdm16022.contentdm.oclc.org/utils/getthumbnail/collection/p16022coll110/id/30", "thumb_cdn_url"=>"https://d2y23onbq5rnfc.cloudfront.net/b065dcd4728675324d6a453bf6ce0b7528fdef69.png"}]
    end
  end
