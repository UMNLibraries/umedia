require 'test_helper'

  class SearchWithChilrenTest < ActiveSupport::TestCase
    it 'runs a search and returns child page data included in search results' do
      results = SearchWithChildren.new(param_string: 'q=libraries', rows: 1)
      results.docs.must_equal [{"id"=>"p16022coll251:3420", "object"=>"https://cdm16022.contentdm.oclc.org/utils/getthumbnail/collection/p16022coll251/id/3420", "set_spec"=>"p16022coll251", "collection_name"=>"Historical Maps", "collection_name_s"=>"Historical Maps", "collection_description"=>"The James Ford Bell Library makes history come alive through its collection of maps, rare books, & manuscripts that focus on trade & cross-cultural interaction circa 1800. Our premier collection of more than 25,000 rare books, maps, and manuscripts illustrates the ways in which cultural influences expanded worldwide, with a special emphasis on European interactions. The Bell Library, its collection, and its innovative programs support scholarship and education at all levels, and enrich our community by advancing understanding of this global heritage, making the world we live in more meaningful. The items in the collection currently date between 400 C.E. and 1825 C.E.", "super_collection_names"=>["Revealing Bound Maps"], "super_collection_name_ss"=>["Revealing Bound Maps"], "super_collection_set_specs"=>["p16022coll432"], "super_collection_descriptions"=>["Access to thousands of maps bound into approximately 11,000 rare books and atlases of the early modern period (circa 1350 - 1800.)"], "title"=>"15th Century, Afghanistan and Pakistan", "title_s"=>"15th Century, Afghanistan and Pakistan", "title_t"=>"15th Century, Afghanistan and Pakistan", "title_search"=>"15th Century, Afghanistan and Pakistan", "title_sort"=>"15thcenturyafghanistanandpakistan", "date_created"=>["1482"], "date_created_ss"=>["1482"], "date_created_sort"=>"1482", "creator"=>["Ptolemy, active 2nd century"], "creator_ss"=>["Ptolemy, active 2nd century"], "creator_sort"=>"ptolemyactive2ndcentury", "notes"=>"Ptolemy, 2nd cent. Cosmographia. (Ulm : Lienhart Holle, 1482)", "types"=>["Cartographic"], "format"=>["Maps | http://vocab.getty.edu/aat/300028094"], "format_name"=>["Maps"], "dimensions"=>"13 7/8 inches wide x 14 5/8 inches high", "language"=>["Latin"], "country"=>["Afghanistan; Pakistan"], "region"=>["Aria; Paropamisadae; Arachosia; Drangiana; Gedrosia"], "continent"=>["Asia"], "contributing_organization"=>"University of Minnesota Libraries, James Ford Bell Library.", "contributing_organization_name"=>"University of Minnesota Libraries, James Ford Bell Library.", "contributing_organization_name_s"=>"University of Minnesota Libraries, James Ford Bell Library.", "contact_information"=>"University of Minnesota Libraries, James Ford Bell Library. 15 Elmer L. Andersen Library, 222 - 21st Avenue South, Minneapolis, MN 55455; https://www.lib.umn.edu/bell", "fiscal_sponsor"=>"This project was funded by the National Endowment for the Humanities.", "local_identifier"=>["Bell Call # 1482 oPt (29th folded, left hand page); Map ID 1482_oPt_m029"], "dls_identifier"=>["1482_oPt_m029"], "persistent_url"=>"http://purl.umn.edu/247043", "local_rights"=>"Use of this item may be governed by US and international copyright laws. You may be able to use this item, but copyright and other considerations may apply. For possible additional information or guidance on your use, please contact the contributing organization.", "page_count"=>0, "record_type"=>"primary", "first_viewer_type"=>"image", "viewer_type"=>"image", "attachment"=>"1652.jp2", "document_type"=>"item", "featured_collection_order"=>999, "_version_"=>1637516776225898496, "type"=>"Cartographic", "collection"=>"p16022coll251", "is_compound"=>false, "parent_id"=>"3420", "thumb_url"=>"https://cdm16022.contentdm.oclc.org/utils/getthumbnail/collection/p16022coll251/id/3420", "thumb_cdn_url"=>"https://d2y23onbq5rnfc.cloudfront.net/ace97a808f9fcbc09dc4346135ef8c16f186ac97.png"}]
    end
  end
