require 'test_helper'

  class SearchWithChilrenTest < ActiveSupport::TestCase
    it 'runs a search and returns child page data included in search results' do
      results = SearchWithChildren.new(param_string: 'q=libraries', rows: 1)
      results.docs.must_equal [{"id"=>"p16022coll202:3", "object"=>"https://cdm16022.contentdm.oclc.org/utils/getthumbnail/collection/p16022coll202/id/3", "set_spec"=>"p16022coll202", "collection_name"=>"E. Ethelbert Miller Collection", "collection_name_s"=>"E. Ethelbert Miller Collection", "collection_description"=>"Correspondence of E. Ethelbert Miller. A poet, essayist, editor and educator, Miller has published poetry collections and has edited several anthologies. [There are several Finding Aids available at: https://z.umn.edu/e-ethelbert-miller]", "title"=>"Photograph of Amiri Baraka", "title_s"=>"Photograph of Amiri Baraka", "title_t"=>"Photograph of Amiri Baraka", "title_search"=>"Photograph of Amiri Baraka", "title_sort"=>"photographofamiribaraka", "description"=>"Photograph of Imamu Amiri Baraka at District of Columbia Public Library.", "types"=>["Still Image"], "format"=>["Black-and-white photographs | http://vocab.getty.edu/aat/300128347"], "format_name"=>["Black-and-white photographs"], "subject"=>["Photography", "African American"], "subject_ss"=>["Photography", "African American"], "city"=>["Washington"], "state"=>["District of Columbia"], "country"=>["United States"], "continent"=>["North America"], "parent_collection"=>"E. Ethelbert Miller collection of Amiri Baraka (GV024); http://archives.lib.umn.edu/repositories/5/resources/7536", "parent_collection_name"=>"E. Ethelbert Miller collection of Amiri Baraka (GV024)", "contributing_organization"=>"University of Minnesota Libraries, Archie Givens, Sr. Collection of African American Literature.", "contributing_organization_name"=>"University of Minnesota Libraries, Archie Givens, Sr. Collection of African American Literature.", "contributing_organization_name_s"=>"University of Minnesota Libraries, Archie Givens, Sr. Collection of African American Literature.", "contact_information"=>"University of Minnesota Libraries, Archie Givens, Sr. Collection of African American Literature. 213 Elmer L. Andersen Library, 222 - 21st Avenue South, Minneapolis, MN 55455; https://www.lib.umn.edu/givens", "local_identifier"=>["Amiri Baraka/Leroi Jones Correspondence, folder \"flyers & publicity (1 of 2)\""], "dls_identifier"=>["giv00054"], "persistent_url"=>"http://purl.umn.edu/184575", "local_rights"=>"Use of this item may be governed by US and international copyright laws. You may be able to use this item, but copyright and other considerations may apply. For possible additional information or guidance on your use, please contact the contributing organization.", "page_count"=>0, "record_type"=>"primary", "first_viewer_type"=>"image", "viewer_type"=>"image", "attachment"=>"3.jp2", "document_type"=>"item", "featured_collection_order"=>999, "_version_"=>1637610728937488384, "type"=>"Still Image", "collection"=>"p16022coll202", "is_compound"=>false, "parent_id"=>"3", "thumb_url"=>"https://cdm16022.contentdm.oclc.org/utils/getthumbnail/collection/p16022coll202/id/3", "thumb_cdn_url"=>"https://d2y23onbq5rnfc.cloudfront.net/904aa22bd5d83a86bc11493cadb95001b4642328.png"}]
    end
  end
